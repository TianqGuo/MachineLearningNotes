⚡ ~  cd ~/MachineLearningNotes/stanford-cs336/assignment2-systems
⚡ master ~/MachineLearningNotes/stanford-cs336/assignment2-systems  source .venv/bin/activate
(cs336-systems) ⚡ master ~/MachineLearningNotes/stanford-cs336/assignment2-systems  cd cs336_systems/torch_compile_benchmarking
(cs336-systems) ⚡ master ~/MachineLearningNotes/stanford-cs336/assignment2-systems/cs336_systems/torch_compile_benchmarking  ./run_all.sh
==============================================================================
Torch.compile Benchmarking - Running All Parts (1.3.1)
==============================================================================

This script will run all torch.compile benchmarking tasks:
  Part (a): Compiled vs vanilla attention (all d_model × seq_len configs)
  Part (b): Compiled vs vanilla Transformer (all 5 model sizes × 4 context lengths)

⚠️  This will take 90-180 minutes to complete (depending on GPU).

Continue? (y/n) y

==============================================================================
Running Part (a): Compiled vs Vanilla Attention
==============================================================================

==============================================================================
Torch.compile Attention Benchmarking - Section 1.3.1(a)
==============================================================================

Configuration:
  Batch size: 8
  d_model values: 16 32 64 128
  seq_len values: 256 1024 4096 8192 16384
  Warmup iterations: 10
  Measurement iterations: 100

This will benchmark 4 × 5 = 20 configurations
For BOTH vanilla and compiled versions (total: 40 tests)

Running benchmarks...

================================================================================
Torch.compile Attention Benchmarking - Section 1.3.1(a)
================================================================================
Batch size: 8
d_model values: [16, 32, 64, 128]
seq_len values: [256, 1024, 4096, 8192, 16384]
Warmup iterations: 10
Measurement iterations: 100

Testing both vanilla and torch.compile versions...

Testing d_model=16, seq_len=256 (vanilla)... ✓ (fwd: 0.08ms, bwd: 0.25ms)
Testing d_model=16, seq_len=256 (compiled)... /teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment2-systems/.venv/lib/python3.12/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
✓ (fwd: 0.12ms, bwd: 0.28ms)
Testing d_model=16, seq_len=1024 (vanilla)... ✓ (fwd: 0.13ms, bwd: 0.32ms)
Testing d_model=16, seq_len=1024 (compiled)... ✓ (fwd: 0.16ms, bwd: 0.32ms)
Testing d_model=16, seq_len=4096 (vanilla)... ✓ (fwd: 1.19ms, bwd: 2.26ms)
Testing d_model=16, seq_len=4096 (compiled)... ✓ (fwd: 0.92ms, bwd: 1.58ms)
Testing d_model=16, seq_len=8192 (vanilla)... ✓ (fwd: 4.33ms, bwd: 8.57ms)
Testing d_model=16, seq_len=8192 (compiled)... ✓ (fwd: 3.55ms, bwd: 6.71ms)
Testing d_model=16, seq_len=16384 (vanilla)... ✓ (fwd: 19.61ms, bwd: 32.91ms)
Testing d_model=16, seq_len=16384 (compiled)... ✓ (fwd: 14.29ms, bwd: 23.85ms)
Testing d_model=32, seq_len=256 (vanilla)... ✓ (fwd: 0.08ms, bwd: 0.28ms)
Testing d_model=32, seq_len=256 (compiled)... ✓ (fwd: 0.15ms, bwd: 0.29ms)
Testing d_model=32, seq_len=1024 (vanilla)... ✓ (fwd: 0.14ms, bwd: 0.34ms)
Testing d_model=32, seq_len=1024 (compiled)... ✓ (fwd: 0.17ms, bwd: 0.34ms)
Testing d_model=32, seq_len=4096 (vanilla)... ✓ (fwd: 1.27ms, bwd: 2.35ms)
Testing d_model=32, seq_len=4096 (compiled)... ✓ (fwd: 1.29ms, bwd: 1.91ms)
Testing d_model=32, seq_len=8192 (vanilla)... ✓ (fwd: 4.67ms, bwd: 8.85ms)
Testing d_model=32, seq_len=8192 (compiled)... ✓ (fwd: 4.78ms, bwd: 7.27ms)
Testing d_model=32, seq_len=16384 (vanilla)... ✓ (fwd: 20.93ms, bwd: 34.12ms)
Testing d_model=32, seq_len=16384 (compiled)... ✓ (fwd: 15.88ms, bwd: 25.36ms)
Testing d_model=64, seq_len=256 (vanilla)... ✓ (fwd: 0.08ms, bwd: 0.27ms)
Testing d_model=64, seq_len=256 (compiled)... ✓ (fwd: 0.14ms, bwd: 0.28ms)
Testing d_model=64, seq_len=1024 (vanilla)... ✓ (fwd: 0.16ms, bwd: 0.35ms)
Testing d_model=64, seq_len=1024 (compiled)... ✓ (fwd: 0.19ms, bwd: 0.36ms)
Testing d_model=64, seq_len=4096 (vanilla)... ✓ (fwd: 1.57ms, bwd: 2.89ms)
Testing d_model=64, seq_len=4096 (compiled)... ✓ (fwd: 1.58ms, bwd: 2.45ms)
Testing d_model=64, seq_len=8192 (vanilla)... ✓ (fwd: 5.91ms, bwd: 11.20ms)
Testing d_model=64, seq_len=8192 (compiled)... ✓ (fwd: 6.01ms, bwd: 9.50ms)
Testing d_model=64, seq_len=16384 (vanilla)... ✓ (fwd: 26.25ms, bwd: 43.97ms)
Testing d_model=64, seq_len=16384 (compiled)... ✓ (fwd: 21.34ms, bwd: 35.27ms)
Testing d_model=128, seq_len=256 (vanilla)... ✓ (fwd: 0.08ms, bwd: 0.28ms)
Testing d_model=128, seq_len=256 (compiled)... ✓ (fwd: 0.15ms, bwd: 0.30ms)
Testing d_model=128, seq_len=1024 (vanilla)... ✓ (fwd: 0.20ms, bwd: 0.43ms)
Testing d_model=128, seq_len=1024 (compiled)... ✓ (fwd: 0.23ms, bwd: 0.44ms)
Testing d_model=128, seq_len=4096 (vanilla)... ✓ (fwd: 2.17ms, bwd: 4.12ms)
Testing d_model=128, seq_len=4096 (compiled)... ✓ (fwd: 2.19ms, bwd: 3.69ms)
Testing d_model=128, seq_len=8192 (vanilla)... ✓ (fwd: 8.27ms, bwd: 15.70ms)
Testing d_model=128, seq_len=8192 (compiled)... ✓ (fwd: 8.35ms, bwd: 14.11ms)
Testing d_model=128, seq_len=16384 (vanilla)... ✓ (fwd: 35.17ms, bwd: 61.69ms)
Testing d_model=128, seq_len=16384 (compiled)... W0108 03:20:20.719000 16184 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [0/8] torch._dynamo hit config.cache_size_limit (8)
W0108 03:20:20.719000 16184 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [0/8]    function: 'naive_attention' (/teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment2-systems/cs336_systems/torch_compile_benchmarking/benchmark_compiled_attention.py:31)
W0108 03:20:20.719000 16184 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [0/8]    last reason: 0/0: tensor 'L['K']' size mismatch at index 1. expected 256, actual 16384
W0108 03:20:20.719000 16184 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0108 03:20:20.719000 16184 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.
✓ (fwd: 35.17ms, bwd: 61.69ms)

Results saved to: ../../results/torch_compile_benchmarking/compiled_attention_benchmark.csv

================================================================================
COMPARISON TABLES: COMPILED vs VANILLA
================================================================================

Forward Pass Timing (ms)
--------------------------------------------------------------------------------

Vanilla:
seq_len     256       1024      4096      8192       16384
d_model
16       0.080043  0.128689  1.189142  4.328434  19.614362
32       0.081168  0.144544  1.274739  4.668203  20.931808
64       0.078130  0.158457  1.565324  5.906600  26.249603
128      0.078767  0.197612  2.173936  8.265247  35.169254

Compiled:
seq_len     256       1024      4096      8192       16384
d_model
16       0.116343  0.161483  0.922128  3.551453  14.287615
32       0.145235  0.171206  1.291616  4.781282  15.882479
64       0.141165  0.189022  1.581744  6.007708  21.336962
128      0.145929  0.230125  2.192476  8.347302  35.166777

Speedup (Vanilla / Compiled):
seq_len     256       1024      4096      8192      16384
d_model
16       0.687993  0.796921  1.289563  1.218779  1.372823
32       0.558869  0.844268  0.986933  0.976350  1.317918
64       0.553464  0.838298  0.989619  0.983170  1.230241
128      0.539759  0.858717  0.991544  0.990170  1.000070


Backward Pass Timing (ms)
--------------------------------------------------------------------------------

Vanilla:
seq_len     256       1024      4096       8192       16384
d_model
16       0.251535  0.315974  2.257647   8.572064  32.909255
32       0.276881  0.335408  2.351893   8.854112  34.118507
64       0.272613  0.352211  2.885826  11.197967  43.966140
128      0.276979  0.434621  4.123051  15.695935  61.693669

Compiled:
seq_len     256       1024      4096       8192       16384
d_model
16       0.283934  0.316026  1.575952   6.710308  23.848425
32       0.287872  0.335445  1.909574   7.268471  25.363829
64       0.282483  0.358404  2.445595   9.502355  35.265474
128      0.295978  0.436931  3.685143  14.109182  61.686868

Speedup (Vanilla / Compiled):
seq_len     256       1024      4096      8192      16384
d_model
16       0.885890  0.999834  1.432560  1.277447  1.379934
32       0.961821  0.999890  1.231632  1.218153  1.345164
64       0.965060  0.982719  1.180010  1.178441  1.246719
128      0.935812  0.994715  1.118831  1.112462  1.000110


================================================================================
SUMMARY
================================================================================

✓ Benchmarking complete
✓ Results saved to: ../../results/torch_compile_benchmarking/compiled_attention_benchmark.csv

Key observations:
  - torch.compile may show speedups on forward/backward passes
  - First iteration after compilation is slower (compilation overhead)
  - Speedups typically improve for larger workloads
  - Memory usage should be similar between compiled and vanilla


==============================================================================
BENCHMARK COMPLETE
==============================================================================

Results saved to: ../../results/torch_compile_benchmarking/compiled_attention_benchmark.csv

==============================================================================
NEXT STEPS FOR WRITEUP
==============================================================================

1. Review the comparison tables in the output above

2. For the writeup (Section 1.3.1(a)), include:
   - Table comparing forward pass timings (vanilla vs compiled)
   - Table comparing backward pass timings (vanilla vs compiled)
   - Speedup ratios for each configuration
   - Brief discussion of performance changes observed

3. Key questions to answer:
   - Where does torch.compile provide the most benefit?
   - Does speedup vary with sequence length or model dimension?
   - Are there cases where compiled is slower (compilation overhead)?

==============================================================================

==============================================================================
Running Part (b): Compiled vs Vanilla Transformer
==============================================================================

==============================================================================
Torch.compile Transformer Benchmarking - Section 1.3.1(b)
==============================================================================

This will benchmark Transformer models comparing vanilla vs torch.compile

Model sizes: small, medium, large, xl, 2.7B
Context lengths: 128, 256, 512, 1024
Pass types: forward-only, forward+backward, full training step

Running benchmarks...

================================================================================
Torch.compile Transformer Benchmarking - Section 1.3.1(b)
================================================================================
Model sizes: ['small', 'medium', 'large', 'xl', '2.7B']
Context lengths: [128, 256, 512, 1024]
Warmup steps: 5
Measure steps: 10


[VANILLA] Creating model (small, ctx=128)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
  [VANILLA] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])

[COMPILED] Creating model (small, ctx=128)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 768])
/teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment2-systems/.venv/lib/python3.12/site-packages/torch/_inductor/compile_fx.py:194: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
  [COMPILED] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])
torch.Size([4, 128])
torch.Size([10000, 768])

  ✓ Complete - small @ ctx=128
    Forward:     33.12ms →    4.97ms (speedup: 6.66x)
    Fwd+Bwd:    114.14ms →   19.16ms (speedup: 5.96x)
    Full step:  118.24ms →   21.77ms (speedup: 5.43x)

[VANILLA] Creating model (small, ctx=256)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
  [VANILLA] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])

[COMPILED] Creating model (small, ctx=256)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
  [COMPILED] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])
torch.Size([4, 256])
torch.Size([10000, 768])

  ✓ Complete - small @ ctx=256
    Forward:     34.55ms →    8.50ms (speedup: 4.06x)
    Fwd+Bwd:    120.51ms →   26.70ms (speedup: 4.51x)
    Full step:  123.83ms →   29.34ms (speedup: 4.22x)

[VANILLA] Creating model (small, ctx=512)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
  [VANILLA] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])

[COMPILED] Creating model (small, ctx=512)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
  [COMPILED] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])
torch.Size([4, 512])
torch.Size([10000, 768])

  ✓ Complete - small @ ctx=512
    Forward:     35.33ms →   15.35ms (speedup: 2.30x)
    Fwd+Bwd:    117.43ms →   46.67ms (speedup: 2.52x)
    Full step:  120.18ms →   49.34ms (speedup: 2.44x)

[VANILLA] Creating model (small, ctx=1024)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
  [VANILLA] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])

[COMPILED] Creating model (small, ctx=1024)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
  [COMPILED] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])
torch.Size([4, 1024])
torch.Size([10000, 768])

  ✓ Complete - small @ ctx=1024
    Forward:     52.41ms →   30.47ms (speedup: 1.72x)
    Fwd+Bwd:    155.65ms →   93.81ms (speedup: 1.66x)
    Full step:  158.08ms →   96.33ms (speedup: 1.64x)

[VANILLA] Creating model (medium, ctx=128)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])

[COMPILED] Creating model (medium, ctx=128)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1024])
W0108 03:41:58.948000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [4/8] torch._dynamo hit config.cache_size_limit (8)
W0108 03:41:58.948000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [4/8]    function: 'torch_dynamo_resume_in_forward_at_124' (/teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment1-basics/cs336_basics/transformer_training/model/transformer_lm.py:124)
W0108 03:41:58.948000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [4/8]    last reason: 4/0: len(L['self']._modules['layers']) == 12
W0108 03:41:58.948000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [4/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0108 03:41:58.948000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [4/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])
torch.Size([4, 128])
torch.Size([10000, 1024])

  ✓ Complete - medium @ ctx=128
    Forward:     81.83ms →   82.38ms (speedup: 0.99x)
    Fwd+Bwd:    294.37ms →  290.35ms (speedup: 1.01x)
    Full step:  302.62ms →  304.68ms (speedup: 0.99x)

[VANILLA] Creating model (medium, ctx=256)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])

[COMPILED] Creating model (medium, ctx=256)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])
torch.Size([4, 256])
torch.Size([10000, 1024])

  ✓ Complete - medium @ ctx=256
    Forward:     82.44ms →   83.32ms (speedup: 0.99x)
    Fwd+Bwd:    290.31ms →  292.81ms (speedup: 0.99x)
    Full step:  305.76ms →  310.47ms (speedup: 0.98x)

[VANILLA] Creating model (medium, ctx=512)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])

[COMPILED] Creating model (medium, ctx=512)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])
torch.Size([4, 512])
torch.Size([10000, 1024])

  ✓ Complete - medium @ ctx=512
    Forward:     83.96ms →   84.48ms (speedup: 0.99x)
    Fwd+Bwd:    294.88ms →  293.84ms (speedup: 1.00x)
    Full step:  302.38ms →  306.41ms (speedup: 0.99x)

[VANILLA] Creating model (medium, ctx=1024)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
  [VANILLA] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])

[COMPILED] Creating model (medium, ctx=1024)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
  [COMPILED] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])
torch.Size([4, 1024])
torch.Size([10000, 1024])

  ✓ Complete - medium @ ctx=1024
    Forward:    146.32ms →  146.76ms (speedup: 1.00x)
    Fwd+Bwd:    440.53ms →  441.21ms (speedup: 1.00x)
    Full step:  448.69ms →  448.73ms (speedup: 1.00x)

[VANILLA] Creating model (large, ctx=128)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])

[COMPILED] Creating model (large, ctx=128)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])
torch.Size([4, 128])
torch.Size([10000, 1280])

  ✓ Complete - large @ ctx=128
    Forward:    146.93ms →  148.83ms (speedup: 0.99x)
    Fwd+Bwd:    543.43ms →  541.20ms (speedup: 1.00x)
    Full step:  561.30ms →  565.47ms (speedup: 0.99x)

[VANILLA] Creating model (large, ctx=256)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])

[COMPILED] Creating model (large, ctx=256)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])
torch.Size([4, 256])
torch.Size([10000, 1280])

  ✓ Complete - large @ ctx=256
    Forward:    146.05ms →  148.53ms (speedup: 0.98x)
    Fwd+Bwd:    539.14ms →  539.05ms (speedup: 1.00x)
    Full step:  572.38ms →  567.51ms (speedup: 1.01x)

[VANILLA] Creating model (large, ctx=512)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])

[COMPILED] Creating model (large, ctx=512)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])
torch.Size([4, 512])
torch.Size([10000, 1280])

  ✓ Complete - large @ ctx=512
    Forward:    168.36ms →  168.88ms (speedup: 1.00x)
    Fwd+Bwd:    557.70ms →  557.89ms (speedup: 1.00x)
    Full step:  578.81ms →  585.09ms (speedup: 0.99x)

[VANILLA] Creating model (large, ctx=1024)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
  [VANILLA] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])

[COMPILED] Creating model (large, ctx=1024)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
  [COMPILED] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])
torch.Size([4, 1024])
torch.Size([10000, 1280])

  ✓ Complete - large @ ctx=1024
    Forward:    314.82ms →  315.19ms (speedup: 1.00x)
    Fwd+Bwd:    960.11ms →  960.49ms (speedup: 1.00x)
    Full step:  979.47ms →  979.69ms (speedup: 1.00x)

[VANILLA] Creating model (xl, ctx=128)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])

[COMPILED] Creating model (xl, ctx=128)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 1600])
W0108 03:46:57.014000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [3/8] torch._dynamo hit config.cache_size_limit (8)
W0108 03:46:57.014000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [3/8]    function: 'torch_dynamo_resume_in_forward_at_73' (/teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment1-basics/cs336_basics/transformer_training/model/embedding.py:73)
W0108 03:46:57.014000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [3/8]    last reason: 3/0: tensor 'L['self']._parameters['weight']' size mismatch at index 1. expected 768, actual 1600. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W0108 03:46:57.014000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [3/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0108 03:46:57.014000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [3/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])
torch.Size([4, 128])
torch.Size([10000, 1600])

  ✓ Complete - xl @ ctx=128
    Forward:    235.50ms →  240.06ms (speedup: 0.98x)
    Fwd+Bwd:    881.53ms →  879.67ms (speedup: 1.00x)
    Full step:  929.80ms →  919.96ms (speedup: 1.01x)

[VANILLA] Creating model (xl, ctx=256)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])

[COMPILED] Creating model (xl, ctx=256)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])
torch.Size([4, 256])
torch.Size([10000, 1600])

  ✓ Complete - xl @ ctx=256
    Forward:    240.23ms →  242.81ms (speedup: 0.99x)
    Fwd+Bwd:    882.87ms →  890.04ms (speedup: 0.99x)
    Full step:  927.79ms →  930.61ms (speedup: 1.00x)

[VANILLA] Creating model (xl, ctx=512)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])

[COMPILED] Creating model (xl, ctx=512)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])
torch.Size([4, 512])
torch.Size([10000, 1600])

  ✓ Complete - xl @ ctx=512
    Forward:    321.44ms →  321.80ms (speedup: 1.00x)
    Fwd+Bwd:    999.06ms → 1000.29ms (speedup: 1.00x)
    Full step: 1045.17ms → 1050.87ms (speedup: 0.99x)

[VANILLA] Creating model (xl, ctx=1024)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
  [VANILLA] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])

[COMPILED] Creating model (xl, ctx=1024)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
  [COMPILED] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])
torch.Size([4, 1024])
torch.Size([10000, 1600])

  ✓ Complete - xl @ ctx=1024
    Forward:    592.17ms →  592.52ms (speedup: 1.00x)
    Fwd+Bwd:   1856.12ms → 1856.03ms (speedup: 1.00x)
    Full step: 1901.12ms → 1901.47ms (speedup: 1.00x)

[VANILLA] Creating model (2.7B, ctx=128)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])

[COMPILED] Creating model (2.7B, ctx=128)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 128])
W0108 03:52:18.052000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [2/8] torch._dynamo hit config.cache_size_limit (8)
W0108 03:52:18.052000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [2/8]    function: 'torch_dynamo_resume_in_forward_at_72' (/teamspace/studios/this_studio/MachineLearningNotes/stanford-cs336/assignment1-basics/cs336_basics/transformer_training/model/embedding.py:72)
W0108 03:52:18.052000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [2/8]    last reason: 2/0: tensor 'L['self']._parameters['weight']' size mismatch at index 1. expected 768, actual 2560. Guard failed on a parameter, consider using torch._dynamo.config.force_parameter_static_shapes = False to allow dynamism on parameters.
W0108 03:52:18.052000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [2/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0108 03:52:18.052000 16824 /system/conda/miniconda3/uv/cache/archive-v0/lPbpM-KDri5arncJPNC1M/torch/_dynamo/convert_frame.py:906] [2/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking full step...
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])
torch.Size([4, 128])
torch.Size([10000, 2560])

  ✓ Complete - 2.7B @ ctx=128
    Forward:    199.25ms →  195.77ms (speedup: 1.02x)
    Fwd+Bwd:    731.90ms →  713.82ms (speedup: 1.03x)
    Full step:  800.89ms →  795.80ms (speedup: 1.01x)

[VANILLA] Creating model (2.7B, ctx=256)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])

[COMPILED] Creating model (2.7B, ctx=256)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking full step...
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])
torch.Size([4, 256])
torch.Size([10000, 2560])

  ✓ Complete - 2.7B @ ctx=256
    Forward:    237.36ms →  237.62ms (speedup: 1.00x)
    Fwd+Bwd:    793.06ms →  780.15ms (speedup: 1.02x)
    Full step:  857.01ms →  858.28ms (speedup: 1.00x)

[VANILLA] Creating model (2.7B, ctx=512)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])

[COMPILED] Creating model (2.7B, ctx=512)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking full step...
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])
torch.Size([4, 512])
torch.Size([10000, 2560])

  ✓ Complete - 2.7B @ ctx=512
    Forward:    397.34ms →  397.57ms (speedup: 1.00x)
    Fwd+Bwd:   1286.02ms → 1288.50ms (speedup: 1.00x)
    Full step: 1364.62ms → 1365.19ms (speedup: 1.00x)

[VANILLA] Creating model (2.7B, ctx=1024)...
  [VANILLA] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
  [VANILLA] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])

[COMPILED] Creating model (2.7B, ctx=1024)...
  [COMPILED] Benchmarking forward pass...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking forward+backward...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
  [COMPILED] Benchmarking full step...
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])
torch.Size([4, 1024])
torch.Size([10000, 2560])

  ✓ Complete - 2.7B @ ctx=1024
    Forward:    807.77ms →  807.62ms (speedup: 1.00x)
    Fwd+Bwd:   2478.53ms → 2478.84ms (speedup: 1.00x)
    Full step: 2554.80ms → 2553.45ms (speedup: 1.00x)

Results saved to: ../../results/torch_compile_benchmarking/compiled_transformer_benchmark.csv

================================================================================
COMPARISON TABLES: COMPILED vs VANILLA TRANSFORMER
================================================================================

Forward Pass Timing (ms)
--------------------------------------------------------------------------------

Vanilla:
context_length        128         256         512         1024
model_size
2.7B            199.245258  237.362826  397.339839  807.774328
large           146.929651  146.045916  168.357572  314.820440
medium           81.834739   82.441862   83.960946  146.322174
small            33.115045   34.545030   35.332044   52.409154
xl              235.495631  240.233232  321.435931  592.166476

Compiled:
context_length        128         256         512         1024
model_size
2.7B            195.769085  237.620247  397.568339  807.623276
large           148.831506  148.527732  168.880434  315.185943
medium           82.382216   83.323138   84.478622  146.759321
small             4.970317    8.500190   15.350820   30.465886
xl              240.057804  242.808828  321.799265  592.518734

Speedup (Vanilla / Compiled):
context_length      128       256       512       1024
model_size
2.7B            1.017756  0.998917  0.999425  1.000187
large           0.987221  0.983291  0.996904  0.998840
medium          0.993354  0.989423  0.993872  0.997021
small           6.662561  4.064030  2.301639  1.720257
xl              0.980996  0.989392  0.998871  0.999405


Forward+Backward Timing (ms)
--------------------------------------------------------------------------------

Vanilla:
context_length        128         256          512          1024
model_size
2.7B            731.897067  793.059855  1286.017989  2478.529358
large           543.426572  539.138403   557.696086   960.114527
medium          294.372892  290.307005   294.883181   440.532712
small           114.141296  120.510003   117.428242   155.647025
xl              881.530094  882.872767   999.057525  1856.115245

Compiled:
context_length        128         256          512          1024
model_size
2.7B            713.815547  780.146179  1288.504042  2478.837211
large           541.195946  539.045534   557.886318   960.494180
medium          290.348642  292.810953   293.844330   441.211249
small            19.161199   26.695907    46.666901    93.807735
xl              879.669780  890.042972  1000.286022  1856.026969

Speedup (Vanilla / Compiled):
context_length      128       256       512       1024
model_size
2.7B            1.025331  1.016553  0.998071  0.999876
large           1.004122  1.000172  0.999659  0.999605
medium          1.013860  0.991449  1.003535  0.998462
small           5.956897  4.514175  2.516307  1.659213
xl              1.002115  0.991944  0.998772  1.000048


Full Training Step Timing (ms) [Forward+Backward+Optimizer]
--------------------------------------------------------------------------------

Vanilla:
context_length        128         256          512          1024
model_size
2.7B            800.886088  857.005279  1364.616927  2554.798330
large           561.299292  572.382778   578.813770   979.471300
medium          302.620081  305.756004   302.380194   448.687400
small           118.235487  123.834794   120.184946   158.075485
xl              929.803235  927.788544  1045.173531  1901.115272

Compiled:
context_length        128         256          512          1024
model_size
2.7B            795.801255  858.282087  1365.193926  2553.445203
large           565.469351  567.510836   585.088545   979.692295
medium          304.677288  310.472157   306.411716   448.726145
small            21.767080   29.341503    49.339675    96.332292
xl              919.959999  930.607813  1050.866306  1901.474221

Speedup (Vanilla / Compiled):
context_length      128       256       512       1024
model_size
2.7B            1.006390  0.998512  0.999577  1.000530
large           0.992625  1.008585  0.989276  0.999774
medium          0.993248  0.984810  0.986843  0.999914
small           5.431849  4.220465  2.435868  1.640940
xl              1.010700  0.996971  0.994583  0.999811


================================================================================
SUMMARY
================================================================================

✓ Benchmarking complete

Key observations:
  - torch.compile optimizes entire model computation graph
  - Speedups vary by model size and operation type
  - Forward pass may see different speedups than backward
  - Optimizer step overhead is similar for both versions


==============================================================================
BENCHMARK COMPLETE
==============================================================================

Results saved to: ../../results/torch_compile_benchmarking/compiled_transformer_benchmark.csv

==============================================================================
NEXT STEPS FOR WRITEUP
==============================================================================

1. Review the comparison tables in the output above

2. For the writeup (Section 1.3.1(b)), include:
   - Table comparing forward pass performance (vanilla vs compiled)
   - Table comparing forward+backward performance
   - Table comparing full training step performance
   - Speedup ratios for each configuration

3. Key questions to answer:
   - How does forward pass performance change with torch.compile?
   - What about forward+backward passes?
   - How does optimizer step affect overall speedup?
   - Do speedups scale with model size?

==============================================================================

==============================================================================
ALL TORCH.COMPILE BENCHMARKING TASKS COMPLETE
==============================================================================

Total time: 40m 12s

Generated files:
  - results/torch_compile_benchmarking/compiled_attention_benchmark.csv
  - results/torch_compile_benchmarking/compiled_transformer_benchmark.csv

Next steps for writeup:

  Part (a): Create tables comparing compiled vs vanilla attention
    - Forward pass timings
    - Backward pass timings
    - Speedup analysis

  Part (b): Create tables comparing compiled vs vanilla Transformer
    - Forward-only performance
    - Forward+backward performance
    - Full training step performance

==============================================================================
(cs336-systems) ⚡ master ~/MachineLearningNotes/stanford-cs336/assignment2-systems/cs336_systems/torch_compile_benchmarking
