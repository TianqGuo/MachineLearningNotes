seq_len,d_model,dtype,batch_size,is_causal,pytorch_forward_ms,pytorch_backward_ms,pytorch_fwd_bwd_ms,flash_forward_ms,flash_backward_ms,flash_fwd_bwd_ms,forward_speedup,backward_speedup,fwd_bwd_speedup
128,16,torch.bfloat16,1,True,0.03133868798613548,0.1314566284418106,0.29039156436920166,0.0062798671424388885,0.12613695859909058,0.2069600522518158,4.990342514469915,1.0421737601873522,1.4031285806589946
128,16,torch.float32,1,True,0.0378425195813179,0.13888078927993774,0.3028075695037842,0.007860434241592884,0.09668644517660141,0.18796223402023315,4.814303945331305,1.4364039243170725,1.6110021839343989
128,32,torch.bfloat16,1,True,0.03136074170470238,0.13434183597564697,0.31405287981033325,0.007056244648993015,0.16855071485042572,0.2969643771648407,4.444395463127517,0.7970410335836535,1.057543947892467
128,32,torch.float32,1,True,0.039896056056022644,0.15119411051273346,0.3204086124897003,0.008988367393612862,0.0981181412935257,0.17249399423599243,4.438632101795572,1.5409394075294205,1.8575059027930154
128,64,torch.bfloat16,1,True,0.031149080023169518,0.12861153483390808,0.2965920567512512,0.007585198152810335,0.11147210001945496,0.19515769183635712,4.106561146544168,1.1537553774573353,1.51975591615394
128,64,torch.float32,1,True,0.04050625488162041,0.14829228818416595,0.33572304248809814,0.015963876619935036,0.10438717901706696,0.17951545119285583,2.5373695779531302,1.4205986748614086,1.8701623746438762
128,128,torch.bfloat16,1,True,0.026719816029071808,0.1283818781375885,0.26963934302330017,0.010598213411867619,0.10165036469697952,0.18835441768169403,2.52116229317968,1.2629750864179958,1.4315530601409734
128,128,torch.float32,1,True,0.03710158169269562,0.13558971881866455,0.32065072655677795,0.028149986639618874,0.10454989969730377,0.20550327003002167,1.3179964227932557,1.2968899942632968,1.5603193394924304
256,16,torch.bfloat16,1,True,0.031656768172979355,0.12361829727888107,0.269610732793808,0.008153480477631092,0.139175683259964,0.18787884712219238,3.8826079561763907,0.8882176425027961,1.4350244155929854
256,16,torch.float32,1,True,0.030894678086042404,0.1331632137298584,0.32851728796958923,0.01014677993953228,0.08371872454881668,0.17163394391536713,3.044776596137208,1.5906025139239963,1.914057793437302
256,32,torch.bfloat16,1,True,0.030031142756342888,0.12507617473602295,0.2665477991104126,0.008993723429739475,0.09014541655778885,0.1900406926870346,3.3391223324745725,1.3874934468336646,1.4025827592060636
256,32,torch.float32,1,True,0.03273427113890648,0.13781782984733582,0.33141952753067017,0.013017655350267887,0.08570566773414612,0.1634223610162735,2.5146057610315244,1.608036358515268,2.0279937547693834
256,64,torch.bfloat16,1,True,0.02752642147243023,0.11698289960622787,0.2503199577331543,0.009396934881806374,0.09637883305549622,0.1684274822473526,2.9292978847522697,1.213782071202995,1.486218011414161
256,64,torch.float32,1,True,0.033815961331129074,0.13282087445259094,0.30583393573760986,0.026170361787080765,0.10263058543205261,0.18585896492004395,1.2921472620918304,1.2941646380895493,1.6455161894890507
256,128,torch.bfloat16,1,True,0.02786507084965706,0.10540880262851715,0.26886099576950073,0.014214001595973969,0.15600812435150146,0.21622858941555023,1.9603959280228078,0.6756622648127022,1.243410949940579
256,128,torch.float32,1,True,0.061593178659677505,0.1567176729440689,0.45440199971199036,0.04722173139452934,0.09085766226053238,0.18478958308696747,1.304339693627013,1.724870187554291,2.4590238915044
512,16,torch.bfloat16,1,True,0.03202293440699577,0.11736626923084259,0.2617437541484833,0.010563562624156475,0.10164441913366318,0.18874168395996094,3.0314521290162633,1.154674995746742,1.3867829758476076
512,16,torch.float32,1,True,0.03623291477560997,0.13097050786018372,0.3027716875076294,0.016034869477152824,0.09049168974161148,0.16763360798358917,2.259632660386553,1.4473208339257981,1.8061514701590735
512,32,torch.bfloat16,1,True,0.03224407136440277,0.11194907128810883,0.24658086895942688,0.013555866666138172,0.10399603098630905,0.18892475962638855,2.3786064114179237,1.076474459903636,1.3051802709557878
512,32,torch.float32,1,True,0.03654154762625694,0.12701831758022308,0.2932005226612091,0.022304894402623177,0.08871221542358398,0.1808810830116272,1.6382748542382455,1.4318018885418962,1.6209573592743356
512,64,torch.bfloat16,1,True,0.03278472647070885,0.12231450527906418,0.2641986012458801,0.013228321447968483,0.09989088028669357,0.17076429724693298,2.4783738889066464,1.2244812031690309,1.5471536234757366
512,64,torch.float32,1,True,0.03816349059343338,0.129410982131958,0.2967350482940674,0.04857295751571655,0.1043289452791214,0.18288934230804443,0.7856941916926713,1.2404130204300656,1.6224840909224234
512,128,torch.bfloat16,1,True,0.03358902409672737,0.12446848303079605,0.27182283997535706,0.0226395633071661,0.17940424382686615,0.29276007413864136,1.483642755869564,0.6937878412224976,0.9284833007885867
512,128,torch.float32,1,True,0.04041657969355583,0.19701892137527466,0.4168638586997986,0.0876653641462326,0.17720413208007812,0.28320199251174927,0.46103247373886286,1.111819002540202,1.471966545865683
1024,16,torch.bfloat16,1,True,0.04463529586791992,0.18492799997329712,0.37488657236099243,0.0165780708193779,0.17195038497447968,0.2910749912261963,2.692430039311105,1.075473020899276,1.2879381041350462
1024,16,torch.float32,1,True,0.05399254709482193,0.14916671812534332,0.342261403799057,0.025783631950616837,0.10064885020256042,0.18266522884368896,2.09406289999149,1.4820508910448402,1.8737085649285685
1024,32,torch.bfloat16,1,True,0.044605743139982224,0.12899041175842285,0.2950230538845062,0.021407045423984528,0.11077988147735596,0.18640369176864624,2.0836945153582844,1.1643848146270965,1.5827103588198899
1024,32,torch.float32,1,True,0.05410464480519295,0.16163216531276703,0.34078675508499146,0.036921244114637375,0.11248359829187393,0.22411935031414032,1.4654068708303152,1.4369398540519813,1.5205592672266919
1024,64,torch.bfloat16,1,True,0.044784557074308395,0.12945841252803802,0.3006010949611664,0.020571380853652954,0.11321461200714111,0.2044721394777298,2.177032129875511,1.1434779507072137,1.470132291514006
1024,64,torch.float32,1,True,0.05251573026180267,0.1347249150276184,0.3373197913169861,0.08464892208576202,0.15964584052562714,0.22606755793094635,0.6203945539743126,0.8438986858914855,1.4921194106941358
1024,128,torch.bfloat16,1,True,0.04723886400461197,0.1328652948141098,0.30005428194999695,0.03927271068096161,0.1643168032169342,0.20247842371463776,1.2028419527331518,0.8085922572306771,1.4819074370752578
1024,128,torch.float32,1,True,0.06271786987781525,0.14802715182304382,0.3279688358306885,0.15816937386989594,0.23754146695137024,0.3743796944618225,0.39652347571031393,0.6231634153094967,0.8760326499602216
2048,16,torch.bfloat16,1,True,0.08843821287155151,0.14283457398414612,0.30016252398490906,0.027642175555229187,0.10755276679992676,0.18157343566417694,3.1993940815132866,1.3280418368952958,1.6531191519670565
2048,16,torch.float32,1,True,0.10262786597013474,0.14640171825885773,0.3332371711730957,0.04687339439988136,0.13583225011825562,0.19340689480304718,2.1894694694949273,1.0778126559149268,1.7229849613812498
2048,32,torch.bfloat16,1,True,0.08884650468826294,0.12027378380298615,0.26483261585235596,0.037165574729442596,0.13950273394584656,0.18970152735710144,2.390559148756515,0.8621607648899206,1.3960489382556465
2048,32,torch.float32,1,True,0.10647901147603989,0.14063717424869537,0.316994845867157,0.068201445043087,0.1952766627073288,0.2308572679758072,1.561242747991199,0.7201944784332758,1.3731204940897794
2048,64,torch.bfloat16,1,True,0.088614821434021,0.12796887755393982,0.2700643539428711,0.035421017557382584,0.1918679028749466,0.19753339886665344,2.5017582086811494,0.6669634453520132,1.367183248465138
2048,64,torch.float32,1,True,0.1196899563074112,0.16295483708381653,0.3051328659057617,0.16421706974506378,0.28620660305023193,0.41400647163391113,0.7288521010222749,0.5693608580205134,0.7370243868447983
2048,128,torch.bfloat16,1,True,0.09203992784023285,0.1325085610151291,0.30015328526496887,0.07250437140464783,0.2996542155742645,0.35626786947250366,1.26943970490492,0.4422048952696577,0.8424932781880695
2048,128,torch.float32,1,True,0.13746552169322968,0.20698221027851105,0.3384697735309601,0.3099670112133026,0.444760262966156,0.7168187499046326,0.44348436033611754,0.4653792784861748,0.4721832033216081
4096,16,torch.bfloat16,1,True,0.22168435156345367,0.2084321528673172,0.41610661149024963,0.04986186325550079,0.2086583375930786,0.21649417281150818,4.445970067895473,0.9989160043716896,1.9220222239077773
4096,16,torch.float32,1,True,0.31037992238998413,0.41574451327323914,0.7140971422195435,0.08831268548965454,0.2564978301525116,0.3055075705051422,3.514556495129387,1.620850020548091,2.337412264576023
4096,32,torch.bfloat16,1,True,0.2214132398366928,0.20515675842761993,0.41762039065361023,0.06874983012676239,0.26250937581062317,0.2820471227169037,3.2205641734451764,0.78152164201412,1.4806759474472078
4096,32,torch.float32,1,True,0.3247929513454437,0.43303656578063965,0.7450268864631653,0.131417915225029,0.35667455196380615,0.4478076100349426,2.471451101543466,1.2140943708946816,1.6637209144458944
4096,64,torch.bfloat16,1,True,0.2208273559808731,0.2087874561548233,0.41750311851501465,0.06452898681163788,0.351530522108078,0.3744606375694275,3.4221419999274905,0.5939383439672747,1.1149452749559206
4096,64,torch.float32,1,True,0.3657854199409485,0.4977598190307617,0.8540489077568054,0.32090193033218384,0.5401972532272339,0.8064823150634766,1.1398666862561506,0.921440855274729,1.0589803295185525
4096,128,torch.bfloat16,1,True,0.22553285956382751,0.2209881693124771,0.4331478774547577,0.1390792429447174,0.5778720378875732,0.6932312846183777,1.6216140869667701,0.38241713532342786,0.6248244807549398
4096,128,torch.float32,1,True,0.45500802993774414,0.6679704189300537,1.111592173576355,0.6123414039611816,0.8676298260688782,1.4135137796401978,0.7430626558882643,0.7698795025944922,0.7864034929035533
8192,16,torch.bfloat16,1,True,0.7072069048881531,0.6423664689064026,1.3371950387954712,0.09451976418495178,0.36006152629852295,0.4413605034351349,7.482106107504926,1.784046397597681,3.0297116039790675
8192,16,torch.float32,1,True,1.067269206047058,1.3859968185424805,2.44279146194458,0.1703893542289734,0.5427666306495667,0.7156698703765869,6.263708263210128,2.5535777998801463,3.413293702945994
8192,32,torch.bfloat16,1,True,0.7063844203948975,0.650449275970459,1.3412398099899292,0.13145409524440765,0.5034569501876831,0.623528003692627,5.373620495288058,1.2919660275381615,2.1510498358484376
8192,32,torch.float32,1,True,1.1054903268814087,1.440650224685669,2.5328824520111084,0.2572088837623596,0.7905440926551819,1.0325777530670166,4.298025444186419,1.822352779649508,2.452970194726555
8192,64,torch.bfloat16,1,True,0.7030361890792847,0.6370041370391846,1.3235894441604614,0.12460378557443619,0.777677059173584,0.8892729878425598,5.642173597200245,0.8191113901651045,1.488394972360045
8192,64,torch.float32,1,True,1.2610162496566772,1.7133859395980835,2.963162660598755,0.636561393737793,1.2012269496917725,1.8271409273147583,1.9809813508359015,1.4263632197377256,1.6217482824127534
8192,128,torch.bfloat16,1,True,0.7188807129859924,0.6704948544502258,1.3726109266281128,0.26652824878692627,1.39757239818573,1.648372769355774,2.697202702745012,0.4797567949400219,0.8327066256770088
8192,128,torch.float32,1,True,1.6011872291564941,2.340824842453003,3.9323036670684814,1.2273107767105103,2.0325403213500977,3.245173931121826,1.3046306278252222,1.1516744921931634,1.2117389546849715
16384,16,torch.bfloat16,1,True,2.6043190956115723,2.313753843307495,4.902122497558594,0.24959713220596313,0.8561103343963623,1.0833375453948975,10.43409061872768,2.702635104783436,4.525018558063245
16384,16,torch.float32,1,True,4.4365410804748535,5.132574081420898,9.5593900680542,0.3359823226928711,2.150269031524658,2.449554920196533,13.204686023110789,2.3869450781150037,3.9025008132037424
16384,32,torch.bfloat16,1,True,2.598243474960327,2.3441483974456787,4.925724983215332,0.3199654221534729,2.045328140258789,2.3536529541015625,8.120388314066224,1.1460989321493815,2.092800034360028
16384,32,torch.float32,1,True,4.599682331085205,5.338220596313477,9.928508758544922,0.4870729148387909,3.087641716003418,3.542224645614624,9.443519011127083,1.72889897446494,2.802902060668767
16384,64,torch.bfloat16,1,True,2.593303680419922,2.343585729598999,4.920931339263916,0.31698548793792725,3.06377911567688,3.345782995223999,8.181143235578494,0.7649329932459022,1.470786164640203
16384,64,torch.float32,1,True,5.280750751495361,6.540699481964111,11.816900253295898,1.2474445104599,4.989872455596924,6.0428080558776855,4.233255032360908,1.3107949231503286,1.9555312934028908
16384,128,torch.bfloat16,1,True,2.6215806007385254,2.351785182952881,4.957337379455566,0.5793378353118896,5.459644317626953,5.953779697418213,4.525132730761808,0.4307579479783932,0.832637019069627
16384,128,torch.float32,1,True,6.618221282958984,9.10074520111084,15.715205192565918,4.30660343170166,7.95405912399292,12.196208000183105,1.5367612523226777,1.1441636351003495,1.2885320742586532
32768,16,torch.bfloat16,1,True,10.0798978805542,9.401776313781738,19.466693878173828,0.8430909514427185,3.2715256214141846,4.093559741973877,11.95588431272477,2.873820168865933,4.755443942485902
32768,16,torch.float32,1,True,16.953651428222656,20.500911712646484,37.45891189575195,1.1468970775604248,6.646605968475342,7.699672698974609,14.782190799792534,3.084418093968818,4.8650005474570985
32768,32,torch.bfloat16,1,True,10.030495643615723,9.455753326416016,19.470623016357422,0.9759175777435303,6.18533992767334,7.132637977600098,10.278015144278632,1.528736243599285,2.7297926906573013
32768,32,torch.float32,1,True,17.593151092529297,21.334224700927734,38.920494079589844,1.9933308362960815,12.09854507446289,14.081379890441895,8.826006587657123,1.7633710970717573,2.7639687574942955
32768,64,torch.bfloat16,1,True,10.029486656188965,9.346952438354492,19.365951538085938,1.0634453296661377,9.169523239135742,10.188106536865234,9.431125772434077,1.019349882713801,1.9008391272716925
32768,64,torch.float32,1,True,20.459928512573242,26.236427307128906,46.6627197265625,5.071187973022461,19.943248748779297,24.818321228027344,4.034543507638703,1.3155543330789978,1.8801722847339999
32768,128,torch.bfloat16,1,True,10.073314666748047,9.34760856628418,19.395761489868164,2.28175687789917,21.79684066772461,23.98246192932129,4.414718660132897,0.42885153443937085,0.8087477235251915
32768,128,torch.float32,1,True,26.167871475219727,36.759613037109375,62.839263916015625,19.438182830810547,31.376062393188477,51.001312255859375,1.346209761631744,1.1715814615759315,1.2321107268920561
65536,16,torch.bfloat16,1,True,39.819087982177734,37.89044952392578,77.64473724365234,3.144015073776245,12.676200866699219,15.77038288116455,12.665043598010307,2.989101381587065,4.923452894500602
65536,16,torch.float32,1,True,73.0429458618164,86.41910552978516,159.50186157226562,4.49169397354126,26.243179321289062,30.7904109954834,16.2617814775634,3.29301204216823,5.1802446416081525
65536,32,torch.bfloat16,1,True,39.518768310546875,37.64905548095703,77.1297607421875,3.6437747478485107,23.66965675354004,27.28147315979004,10.845557435700705,1.5906042015301396,2.827184598516054
65536,32,torch.float32,1,True,75.7356185913086,93.45843505859375,169.1579132080078,6.53640079498291,48.06244659423828,54.51500701904297,11.586746432293495,1.9445209655597835,3.102960495793722
65536,64,torch.bfloat16,1,True,39.59251022338867,38.69539260864258,78.28953552246094,4.111633777618408,34.690513610839844,38.77134704589844,9.629386361915223,1.1154459412947786,2.0192627155765295
65536,64,torch.float32,1,True,82.2771224975586,105.1048355102539,187.38201904296875,22.35721778869629,85.36553955078125,108.65203094482422,3.680114550709326,1.23123260349957,1.7246066862581269
65536,128,torch.bfloat16,1,True,39.96723175048828,39.63304138183594,79.69312286376953,9.039176940917969,87.11507415771484,96.0711669921875,4.421556521320782,0.45495044072491403,0.8295217530796745
65536,128,torch.float32,1,True,100.72185516357422,142.3387451171875,242.8067169189453,77.51193237304688,118.8878402709961,196.9124755859375,1.2994367716034145,1.197252341305358,1.2330692415320248
