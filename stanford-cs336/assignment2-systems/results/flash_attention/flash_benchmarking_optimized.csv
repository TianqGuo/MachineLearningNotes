seq_len,d_model,dtype,batch_size,is_causal,pytorch_forward_ms,pytorch_backward_ms,pytorch_fwd_bwd_ms,flash_forward_ms,flash_backward_ms,flash_fwd_bwd_ms,forward_speedup,backward_speedup,fwd_bwd_speedup
128,16,torch.bfloat16,1,True,0.03377031534910202,0.12779200077056885,0.2965996563434601,0.007061994168907404,0.11002693325281143,0.2729414701461792,4.781980067016509,1.1614610804150853,1.0866786061664073
128,16,torch.float32,1,True,0.04044326767325401,0.19400754570960999,0.32708948850631714,0.008436004631221294,0.09177891165018082,0.17541159689426422,4.794125826291655,2.1138575542176605,1.8646970570793124
128,32,torch.bfloat16,1,True,0.03363608941435814,0.13208328187465668,0.29305511713027954,0.0078011974692344666,0.10374622792005539,0.19183246791362762,4.311657222754401,1.2731381614803114,1.5276617160668928
128,32,torch.float32,1,True,0.04240800812840462,0.13730160892009735,0.31499797105789185,0.009417803026735783,0.09279084950685501,0.19212375581264496,4.502961891219683,1.479689103503186,1.639557636823794
128,64,torch.bfloat16,1,True,0.03402864187955856,0.12934419512748718,0.4777260422706604,0.00869258213788271,0.12402185797691345,0.24608272314071655,3.9146759086992153,1.0429145090824592,1.9413229672262857
128,64,torch.float32,1,True,0.042768996208906174,0.13718457520008087,0.32115429639816284,0.01709812879562378,0.09491650760173798,0.18430045247077942,2.5013846088147837,1.445318403155922,1.7425583719013462
128,128,torch.bfloat16,1,True,0.028494585305452347,0.12158092111349106,0.28531593084335327,0.01038634218275547,0.10406959056854248,0.18937991559505463,2.743466834046941,1.1682655850693988,1.5065796705361076
128,128,torch.float32,1,True,0.03526477888226509,0.13638310134410858,0.33137571811676025,0.028721844777464867,0.109690360724926,0.18830716609954834,1.2278034073192194,1.2433462743925223,1.7597615904940065
256,16,torch.bfloat16,1,True,0.03425470367074013,0.13478071987628937,0.3096647262573242,0.008427747525274754,0.10548298060894012,0.18724173307418823,4.064514696009879,1.2777484964703978,1.653823221848892
256,16,torch.float32,1,True,0.03263785317540169,0.13355571031570435,0.32675641775131226,0.010397335514426231,0.09947066754102707,0.20001456141471863,3.139059341705083,1.3426642609050428,1.633663146523626
256,32,torch.bfloat16,1,True,0.0323723740875721,0.12671637535095215,0.2954201102256775,0.009139097295701504,0.10697529464960098,0.2035168707370758,3.5421850802264867,1.1845386896667436,1.451575533545481
256,32,torch.float32,1,True,0.035170577466487885,0.14862582087516785,0.3498133420944214,0.014049675315618515,0.10693497955799103,0.20716127753257751,2.503301797116267,1.3898709429739762,1.6886039044599483
256,64,torch.bfloat16,1,True,0.029709406197071075,0.13617581129074097,0.2755237817764282,0.010416761040687561,0.111224465072155,0.2669530212879181,2.852077155367874,1.2243332544004524,1.0321058755850014
256,64,torch.float32,1,True,0.05391223728656769,0.16184352338314056,0.328422874212265,0.02751084417104721,0.09220745414495468,0.1834569275379181,1.959672227844817,1.7552108436777198,1.7901906383141863
256,128,torch.bfloat16,1,True,0.029873358085751534,0.11781935393810272,0.27654093503952026,0.014857080765068531,0.10360339283943176,0.2583348751068115,2.0107151975634925,1.1372152080067819,1.070474650103596
256,128,torch.float32,1,True,0.037960655987262726,0.1950906664133072,0.4263310730457306,0.04871572181582451,0.11685534566640854,0.25860610604286194,0.7792280309584128,1.6695057063990897,1.6485731120945364
512,16,torch.bfloat16,1,True,0.0337480828166008,0.15146169066429138,0.2983049154281616,0.010596880689263344,0.1663980931043625,0.28456032276153564,3.184718579571631,0.9102369374467337,1.048301156441069
512,16,torch.float32,1,True,0.03769492730498314,0.1927434802055359,0.39943236112594604,0.0156547874212265,0.1712053269147873,0.26776862144470215,2.407884967755753,1.1258030557744771,1.4917071274851905
512,32,torch.bfloat16,1,True,0.033783696591854095,0.18008188903331757,0.3684486150741577,0.01308475062251091,0.16868752241134644,0.2808913290500641,2.5819136769586475,1.0675471810783126,1.3117123135135582
512,32,torch.float32,1,True,0.03802213817834854,0.19039790332317352,0.39560067653656006,0.022212382405996323,0.12450623512268066,0.27472251653671265,1.7117541686156237,1.5292238427703426,1.4400009199234816
512,64,torch.bfloat16,1,True,0.03419199958443642,0.12255357205867767,0.37165936827659607,0.013292479328811169,0.15884433686733246,0.27522554993629456,2.57228156904679,0.771532523448003,1.3503810542394146
512,64,torch.float32,1,True,0.03939127177000046,0.186793714761734,0.32180142402648926,0.04855877533555031,0.10211848467588425,0.21934068202972412,0.8112080977701627,1.8291861199723247,1.4671305890390187
512,128,torch.bfloat16,1,True,0.03474860638380051,0.18257418274879456,0.352284699678421,0.02310268022119999,0.17353194952011108,0.27995815873146057,1.5040941592531643,1.0521070226761646,1.2583476805058464
512,128,torch.float32,1,True,0.041079968214035034,0.18804192543029785,0.40375816822052,0.08741708844900131,0.17698480188846588,0.27950894832611084,0.4699306387675092,1.0624749889473564,1.4445268054511233
1024,16,torch.bfloat16,1,True,0.045372374355793,0.13281108438968658,0.30403849482536316,0.016623808071017265,0.09915652126073837,0.1914159208536148,2.729361056261071,1.3394084695695545,1.5883657611629725
1024,16,torch.float32,1,True,0.05424894765019417,0.13931860029697418,0.33845940232276917,0.025928428396582603,0.10870582610368729,0.1773861199617386,2.092257456581682,1.2816111637299679,1.9080376886070534
1024,32,torch.bfloat16,1,True,0.04552774131298065,0.12209326028823853,0.2944619953632355,0.02136041969060898,0.10626307129859924,0.18605375289916992,2.1314066845323616,1.1489716869292856,1.5826716245966637
1024,32,torch.float32,1,True,0.0552702471613884,0.14277343451976776,0.33981749415397644,0.03663473576307297,0.11421165615320206,0.192921444773674,1.5086842039433959,1.2500776131663243,1.7614293452582925
1024,64,torch.bfloat16,1,True,0.04600681737065315,0.128068745136261,0.3007703125476837,0.020075883716344833,0.11556147783994675,0.2116059809923172,2.291645938016496,1.1082304201200757,1.4213696188417464
1024,64,torch.float32,1,True,0.05356510356068611,0.14273665845394135,0.32022765278816223,0.08360220491886139,0.1634856015443802,0.22484725713729858,0.6407140052427176,0.8730839725674173,1.424200841341024
1024,128,torch.bfloat16,1,True,0.04782140254974365,0.1459568589925766,0.3183573782444,0.03940517455339432,0.18050090968608856,0.20493637025356293,1.2135817971049787,0.8086211822777627,1.553444992953198
1024,128,torch.float32,1,True,0.06230555474758148,0.1374935358762741,0.34612932801246643,0.158384308218956,0.25127434730529785,0.37878918647766113,0.39338211877308016,0.5471849289462872,0.9137782713152484
2048,16,torch.bfloat16,1,True,0.08969958871603012,0.1307794153690338,0.31753596663475037,0.027430683374404907,0.11480572074651718,0.19641034305095673,3.2700457182093845,1.1391367478784913,1.6166967670962664
2048,16,torch.float32,1,True,0.11280538141727448,0.1556185781955719,0.35805249214172363,0.04535536840558052,0.13192884624004364,0.1886824369430542,2.487145080788163,1.1795644594088617,1.8976461081525389
2048,32,torch.bfloat16,1,True,0.09108653664588928,0.13558360934257507,0.3206035792827606,0.03622870892286301,0.15148459374904633,0.20372119545936584,2.514208740913947,0.89503233290632,1.5737369818581695
2048,32,torch.float32,1,True,0.11588677018880844,0.15597808361053467,0.3463800251483917,0.0683027058839798,0.20584245026111603,0.23293890058994293,1.6966644101282866,0.7577546974041204,1.4869994847195849
2048,64,torch.bfloat16,1,True,0.09032487124204636,0.12851060926914215,0.31939664483070374,0.034530509263277054,0.2037673145532608,0.21222959458827972,2.6157989896229594,0.6306733224162503,1.5049580877272348
2048,64,torch.float32,1,True,0.12813593447208405,0.17661048471927643,0.33724531531333923,0.1619829684495926,0.31246429681777954,0.41816940903663635,0.7910457235012248,0.5652181273762318,0.8064801203183964
2048,128,torch.bfloat16,1,True,0.09420038014650345,0.135250523686409,0.31981268525123596,0.07102282345294952,0.33278656005859375,0.38851505517959595,1.3263395563104916,0.4064182269337903,0.8231667756179964
2048,128,torch.float32,1,True,0.14426572620868683,0.22302310168743134,0.3633491098880768,0.31021857261657715,0.47384753823280334,0.7357223629951477,0.4650454194017451,0.47066426158757235,0.4938671544641809
4096,16,torch.bfloat16,1,True,0.25081104040145874,0.25677597522735596,0.4904543161392212,0.0491337887942791,0.19143915176391602,0.20433416962623596,5.104654995192676,1.3412929009631933,2.4002559974983653
4096,16,torch.float32,1,True,0.3671055734157562,0.5037252306938171,0.8600348830223083,0.08512596040964127,0.2462180107831955,0.28690633177757263,4.312498462856441,2.0458504602953953,2.9976155552016888
4096,32,torch.bfloat16,1,True,0.2490171492099762,0.25096386671066284,0.4889834225177765,0.06765272468328476,0.2655050754547119,0.29407086968421936,3.6808147842639944,0.9452318991674816,1.6628080946707136
4096,32,torch.float32,1,True,0.3815973103046417,0.5230429172515869,0.891894519329071,0.1312970370054245,0.3580441176891327,0.4512217342853546,2.906366503067972,1.4608337112961938,1.9766213627578344
4096,64,torch.bfloat16,1,True,0.24872004985809326,0.2539721727371216,0.4893701374530792,0.06416758894920349,0.3808002769947052,0.410961389541626,3.876100909058398,0.6669432457914228,1.1907934660210002
4096,64,torch.float32,1,True,0.416415810585022,0.5819950699806213,0.9952809810638428,0.31992921233177185,0.5818740725517273,0.8205188512802124,1.301587334116873,1.0002079443553198,1.2129897801993923
4096,128,torch.bfloat16,1,True,0.2530730664730072,0.26801642775535583,0.5045242309570312,0.1359994262456894,0.6559394598007202,0.7739357352256775,1.8608392215994995,0.40859933603747733,0.6518942180773103
4096,128,torch.float32,1,True,0.5040813684463501,0.7509719729423523,1.2512950897216797,0.6200730204582214,0.9572978019714355,1.4628605842590332,0.8129387214329115,0.7844705914876428,0.8553754904507763
8192,16,torch.bfloat16,1,True,0.81819087266922,0.8261107802391052,1.632354736328125,0.09258846938610077,0.40887996554374695,0.48741862177848816,8.83685493554606,2.020423718096596,3.348979015967846
8192,16,torch.float32,1,True,1.301018238067627,1.7354506254196167,3.033416986465454,0.16638782620429993,0.494679719209671,0.6420333385467529,7.819191269859892,3.508230796670365,4.7247032269875815
8192,32,torch.bfloat16,1,True,0.8166053295135498,0.8348645567893982,1.6373393535614014,0.12974970042705536,0.5942349433898926,0.7071964740753174,6.293697224932256,1.404940194238329,2.3152538418722695
8192,32,torch.float32,1,True,1.3394957780838013,1.781451940536499,3.1123437881469727,0.25674328207969666,0.763148844242096,1.000594973564148,5.217257360089381,2.334344019489026,3.1104931269649647
8192,64,torch.bfloat16,1,True,0.8170995712280273,0.8268202543258667,1.6295852661132812,0.12182071805000305,0.8576611280441284,0.9553627967834473,6.7073941469679825,0.9640407234164926,1.7057240156303266
8192,64,torch.float32,1,True,1.4659395217895508,2.0409250259399414,3.522791624069214,0.636651337146759,1.2860113382339478,1.894083857536316,2.3025782500659804,1.5870194649626501,1.8598921109287108
8192,128,torch.bfloat16,1,True,0.8293421864509583,0.8551846146583557,1.6718075275421143,0.2568604648113251,1.7442675828933716,1.9666680097579956,3.2287654196224604,0.49028292622384523,0.8500710436368135
8192,128,torch.float32,1,True,1.8073079586029053,2.6702396869659424,4.486886024475098,1.2340210676193237,2.321052074432373,3.4978880882263184,1.4645681552986514,1.150443678700731,1.2827414460678965
16384,16,torch.bfloat16,1,True,3.0535058975219727,3.0718326568603516,6.129430294036865,0.2445300966501236,0.8910152912139893,1.1170871257781982,12.487239564179141,3.4475644662338456,5.486976040268041
16384,16,torch.float32,1,True,5.362302780151367,6.534662246704102,11.93947982788086,0.33006319403648376,1.9439719915390015,2.1517553329467773,16.246291246756346,3.3615002042960236,5.548716271347648
16384,32,torch.bfloat16,1,True,3.0438296794891357,3.0883219242095947,6.138393878936768,0.3126351535320282,2.1851253509521484,2.4849448204040527,9.736044219919458,1.4133385633295072,2.470233475018839
16384,32,torch.float32,1,True,5.5116801261901855,6.730827331542969,12.30063247680664,0.4803118407726288,2.930605888366699,3.3601510524749756,11.475211848461004,2.2967357563367994,3.6607379503806543
16384,64,torch.bfloat16,1,True,3.0564706325531006,3.1011552810668945,6.152020454406738,0.3109581768512726,3.495973587036133,3.736745595932007,9.829201674329896,0.8870648487067194,1.6463578524329059
16384,64,torch.float32,1,True,6.244688987731934,7.99656867980957,14.38177490234375,1.2501171827316284,5.271772384643555,6.243317127227783,4.995282901469026,1.5168653151837947,2.3035470742985757
16384,128,torch.bfloat16,1,True,3.0805232524871826,3.129612684249878,6.218143939971924,0.5700191855430603,6.683497428894043,7.212699890136719,5.404244858096051,0.46825972741755856,0.8621104488868533
16384,128,torch.float32,1,True,7.464283466339111,10.448612213134766,18.018329620361328,4.413205146789551,9.273698806762695,13.357107162475586,1.6913520260369295,1.1266930736973346,1.3489694588196923
32768,16,torch.bfloat16,1,True,11.926424026489258,12.67481517791748,24.648902893066406,0.8251696825027466,3.3909809589385986,4.189739227294922,14.45329885402032,3.737801931475542,5.883159202960899
32768,16,torch.float32,1,True,20.651416778564453,26.2739200592041,47.00761413574219,1.133264422416687,6.316000461578369,7.406348705291748,18.222946357501716,4.159898375409277,6.346935042655473
32768,32,torch.bfloat16,1,True,11.927760124206543,12.719749450683594,24.660688400268555,0.9610956907272339,6.649247646331787,7.56333589553833,12.410585375927703,1.9129607028098496,3.2605570796896757
32768,32,torch.float32,1,True,21.315959930419922,27.088083267211914,48.46684646606445,2.0119426250457764,11.491636276245117,13.513986587524414,10.59471560722808,2.3571998465707553,3.58642108693575
32768,64,torch.bfloat16,1,True,11.968572616577148,12.748273849487305,24.74821662902832,1.0479599237442017,10.555354118347168,11.460304260253906,11.420830458683245,1.2077542550020595,2.159472913372722
32768,64,torch.float32,1,True,23.943105697631836,31.7869873046875,55.8889274597168,5.024801731109619,22.270233154296875,27.03206443786621,4.764985163373703,1.4273306922498221,2.0675049657483138
32768,128,torch.bfloat16,1,True,12.024269104003906,12.755849838256836,24.778512954711914,2.241541624069214,26.508522033691406,28.64206886291504,5.364285443058372,0.48119807743504506,0.8651090489763625
32768,128,torch.float32,1,True,29.60590934753418,42.12745666503906,71.81056213378906,19.26538848876953,38.021488189697266,56.56492614746094,1.5367408430301055,1.1079907355245078,1.2695245450614359
65536,16,torch.bfloat16,1,True,48.71514892578125,50.66960144042969,99.49632263183594,3.0928494930267334,13.490811347961426,16.450456619262695,15.750895423659134,3.7558602024396617,6.048240783500837
65536,16,torch.float32,1,True,ERROR,ERROR,ERROR,ERROR,ERROR,ERROR,N/A,N/A,N/A
65536,32,torch.bfloat16,1,True,48.679264068603516,50.5437126159668,99.21052551269531,3.565751791000366,25.92995262145996,29.405044555664062,13.651893603886158,1.9492404538424097,3.3739287599067818
65536,32,torch.float32,1,True,ERROR,ERROR,ERROR,ERROR,ERROR,ERROR,N/A,N/A,N/A
65536,64,torch.bfloat16,1,True,48.86918258666992,51.41936111450195,100.23887634277344,4.0405707359313965,40.62656021118164,44.519309997558594,12.09462370058101,1.2656587426358044,2.251581984273127
65536,64,torch.float32,1,True,ERROR,ERROR,ERROR,ERROR,ERROR,ERROR,N/A,N/A,N/A
65536,128,torch.bfloat16,1,True,49.240543365478516,52.652671813964844,101.84175872802734,8.83493423461914,104.67436981201172,113.48131561279297,5.573391047160545,0.5030139843070045,0.8974319532522808
65536,128,torch.float32,1,True,ERROR,ERROR,ERROR,ERROR,ERROR,ERROR,N/A,N/A,N/A
